<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>STP Calculator — Wealth Builder</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }

    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      height: 6px;
      border-radius: 9999px;
      background: rgba(255,255,255,0.18);
      outline: none;
      cursor: pointer;
      accent-color: #D4AF37;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #D4AF37;
      cursor: pointer;
      border: 2px solid #1A237E;
      box-shadow: 0 2px 6px rgba(212,175,55,0.45);
    }
    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #D4AF37;
      cursor: pointer;
      border: 2px solid #1A237E;
      box-shadow: 0 2px 6px rgba(212,175,55,0.45);
    }

    .card-glass {
      background: rgba(255,255,255,0.09);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 1rem;
    }
    .label-muted { color: rgba(255,255,255,0.7); }
    .gold { color: #D4AF37; }

    /* Flow diagram */
    .flow-box {
      border-radius: 0.75rem;
      padding: 1rem 1.25rem;
      text-align: center;
      flex: 1;
      min-width: 0;
    }
    .flow-box-debt {
      background: rgba(59,130,246,0.18);
      border: 2px solid rgba(59,130,246,0.5);
    }
    .flow-box-equity {
      background: rgba(5,150,105,0.18);
      border: 2px solid rgba(5,150,105,0.5);
    }

    @keyframes flowPulse {
      0%, 100% { opacity: 1; transform: scaleX(1); }
      50%       { opacity: 0.55; transform: scaleX(0.93); }
    }
    .flow-arrow-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      flex-shrink: 0;
      animation: flowPulse 1.8s ease-in-out infinite;
    }

    /* Comparison badge */
    .badge-better {
      background: rgba(34,197,94,0.15);
      border: 1px solid rgba(34,197,94,0.4);
      color: #4ade80;
      border-radius: 0.5rem;
      padding: 0.5rem 0.85rem;
      font-size: 0.78rem;
      font-weight: 600;
    }
    .badge-worse {
      background: rgba(239,68,68,0.12);
      border: 1px solid rgba(239,68,68,0.35);
      color: #f87171;
      border-radius: 0.5rem;
      padding: 0.5rem 0.85rem;
      font-size: 0.78rem;
      font-weight: 600;
    }

    table { border-collapse: collapse; }
    th, td { border-bottom: 1px solid rgba(255,255,255,0.08); }
  </style>
</head>
<body class="min-h-screen" style="background: linear-gradient(180deg, #0D1B4B 0%, #1A237E 100%); min-height: 100vh;">

  <!-- Navbar -->
  <nav style="background: #0D1B4B; min-height: 64px; border-bottom: 2px solid rgba(212,175,55,0.25);" class="px-4 flex items-center shadow-lg">
    <div class="max-w-5xl mx-auto w-full flex items-center justify-between">
      <a href="../index.html" class="flex items-center gap-2 no-underline" style="text-decoration: none;">
        <i class="ph ph-coin" style="font-size: 1.6rem; color: #D4AF37;"></i>
        <div>
          <div class="font-bold" style="color: #D4AF37; font-size: 1.05rem; letter-spacing: 0.4px; line-height: 1.2;">Wealth Builder</div>
          <div style="color: rgba(255,255,255,0.55); font-size: 0.7rem; letter-spacing: 0.5px;">Portfolio Optimizer (STP)</div>
        </div>
      </a>
      <span class="text-sm font-medium" style="color: rgba(255,255,255,0.65);">STP Calculator</span>
    </div>
  </nav>

  <!-- Hero -->
  <section class="text-center py-10 px-4">
    <div class="max-w-2xl mx-auto">
      <div class="flex items-center justify-center gap-3 mb-3">
        <i class="ph ph-arrows-left-right" style="font-size: 2rem; color: #D4AF37;"></i>
        <h1 class="font-extrabold" style="font-size: 1.9rem; color: #ffffff; letter-spacing: -0.3px;">STP Calculator</h1>
      </div>
      <p style="color: rgba(255,255,255,0.65); font-size: 0.95rem; line-height: 1.7;">
        Invest a lump sum in a Debt fund for safety, then systematically transfer a fixed amount each month into an Equity fund for growth — the smart way to deploy a large corpus.
      </p>
    </div>
  </section>

  <!-- Main Content -->
  <section class="pb-12 px-4">
    <div class="max-w-3xl mx-auto space-y-6">

      <!-- Flow Diagram Card -->
      <div class="card-glass p-6">
        <div class="flex items-center gap-2 mb-5">
          <i class="ph ph-flow-arrow" style="font-size: 1.2rem; color: #D4AF37;"></i>
          <h2 class="font-bold text-white" style="font-size: 0.95rem; letter-spacing: 0.2px;">Live Fund Flow</h2>
        </div>
        <div class="flex items-stretch gap-3" id="flowDiagram">

          <!-- Debt Fund Box -->
          <div class="flow-box flow-box-debt">
            <div class="flex items-center justify-center gap-1.5 mb-2">
              <i class="ph ph-bank" style="font-size: 1.3rem; color: #60a5fa;"></i>
              <span class="font-bold text-white text-sm">DEBT FUND</span>
            </div>
            <div class="text-xs font-medium mb-3" style="color: rgba(96,165,250,0.85);">Safety &amp; Stability</div>
            <div id="flowDebtVal" class="font-extrabold" style="font-size: 1.15rem; color: #93c5fd;">Rs. 4,50,000</div>
            <div class="text-xs mt-1" style="color: rgba(255,255,255,0.5);">remaining</div>
          </div>

          <!-- Animated Arrow -->
          <div class="flow-arrow-wrap" style="min-width: 90px;">
            <div style="color: #D4AF37; font-size: 0.72rem; font-weight: 600; white-space: nowrap;">Monthly Transfer</div>
            <div class="flex items-center gap-1">
              <div style="height: 2px; width: 28px; background: linear-gradient(90deg, #D4AF37, transparent);"></div>
              <i class="ph ph-arrow-right" style="font-size: 1.4rem; color: #D4AF37;"></i>
              <div style="height: 2px; width: 28px; background: linear-gradient(90deg, transparent, #D4AF37);"></div>
            </div>
            <div id="flowTransferVal" class="font-extrabold" style="font-size: 0.95rem; color: #D4AF37; white-space: nowrap;">Rs. 25,000/mo</div>
          </div>

          <!-- Equity Fund Box -->
          <div class="flow-box flow-box-equity">
            <div class="flex items-center justify-center gap-1.5 mb-2">
              <i class="ph ph-trend-up" style="font-size: 1.3rem; color: #34d399;"></i>
              <span class="font-bold text-white text-sm">EQUITY FUND</span>
            </div>
            <div class="text-xs font-medium mb-3" style="color: rgba(52,211,153,0.85);">Growth Engine</div>
            <div id="flowEquityVal" class="font-extrabold" style="font-size: 1.15rem; color: #6ee7b7;">Rs. 0</div>
            <div class="text-xs mt-1" style="color: rgba(255,255,255,0.5);">growing</div>
          </div>

        </div>
      </div>

      <!-- Calculator Inputs Card -->
      <div class="card-glass p-6 md:p-8">

        <!-- Initial Lump Sum -->
        <div class="mb-7">
          <div class="flex items-center justify-between mb-2">
            <label class="text-sm font-semibold label-muted">Initial Lump Sum (Rs.)</label>
            <span id="lumpSumVal" class="text-sm font-bold px-3 py-1 rounded-full"
              style="background: rgba(212,175,55,0.18); color: #D4AF37; border: 1.5px solid rgba(212,175,55,0.35);">Rs. 5,00,000</span>
          </div>
          <input type="range" id="lumpSum" min="100000" max="10000000" step="50000" value="500000" class="w-full">
          <div class="flex justify-between mt-1 text-xs label-muted">
            <span>Rs. 1,00,000</span><span>Rs. 1,00,00,000</span>
          </div>
        </div>

        <!-- Monthly Transfer -->
        <div class="mb-7">
          <div class="flex items-center justify-between mb-2">
            <label class="text-sm font-semibold label-muted">Monthly Transfer Amount (Rs.)</label>
            <span id="transferVal" class="text-sm font-bold px-3 py-1 rounded-full"
              style="background: rgba(212,175,55,0.18); color: #D4AF37; border: 1.5px solid rgba(212,175,55,0.35);">Rs. 25,000</span>
          </div>
          <input type="range" id="transfer" min="5000" max="200000" step="5000" value="25000" class="w-full">
          <div class="flex justify-between mt-1 text-xs label-muted">
            <span>Rs. 5,000</span><span>Rs. 2,00,000</span>
          </div>
        </div>

        <!-- Debt Fund Return -->
        <div class="mb-7">
          <div class="flex items-center justify-between mb-2">
            <label class="text-sm font-semibold label-muted">
              <span style="color: #93c5fd;">Debt Fund</span> Return (%)
            </label>
            <span id="debtRateVal" class="text-sm font-bold px-3 py-1 rounded-full"
              style="background: rgba(59,130,246,0.18); color: #93c5fd; border: 1.5px solid rgba(59,130,246,0.35);">7%</span>
          </div>
          <input type="range" id="debtRate" min="4" max="12" step="0.5" value="7" class="w-full">
          <div class="flex justify-between mt-1 text-xs label-muted">
            <span>4%</span><span>12%</span>
          </div>
        </div>

        <!-- Equity Fund Return -->
        <div class="mb-7">
          <div class="flex items-center justify-between mb-2">
            <label class="text-sm font-semibold label-muted">
              <span style="color: #6ee7b7;">Equity Fund</span> Return (%)
            </label>
            <span id="equityRateVal" class="text-sm font-bold px-3 py-1 rounded-full"
              style="background: rgba(5,150,105,0.18); color: #6ee7b7; border: 1.5px solid rgba(5,150,105,0.35);">14%</span>
          </div>
          <input type="range" id="equityRate" min="8" max="30" step="0.5" value="14" class="w-full">
          <div class="flex justify-between mt-1 text-xs label-muted">
            <span>8%</span><span>30%</span>
          </div>
        </div>

        <!-- STP Duration -->
        <div class="mb-2">
          <div class="flex items-center justify-between mb-2">
            <label class="text-sm font-semibold label-muted">STP Duration (Months)</label>
            <span id="durationVal" class="text-sm font-bold px-3 py-1 rounded-full"
              style="background: rgba(212,175,55,0.18); color: #D4AF37; border: 1.5px solid rgba(212,175,55,0.35);">24 months</span>
          </div>
          <input type="range" id="duration" min="6" max="60" step="1" value="24" class="w-full">
          <div class="flex justify-between mt-1 text-xs label-muted">
            <span>6 months</span><span>60 months</span>
          </div>
        </div>

      </div>

      <!-- Results Summary Card -->
      <div class="card-glass p-6 md:p-8">

        <div class="flex items-center gap-2 mb-6">
          <i class="ph ph-chart-pie-slice" style="font-size: 1.3rem; color: #D4AF37;"></i>
          <h2 class="font-bold text-white" style="font-size: 1.05rem;">STP Results</h2>
        </div>

        <!-- 3 summary cards -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-7">

          <div class="rounded-xl p-4 text-center" style="background: rgba(59,130,246,0.12); border: 1px solid rgba(59,130,246,0.3);">
            <div class="flex items-center justify-center gap-1.5 mb-1">
              <i class="ph ph-bank" style="font-size: 1rem; color: #60a5fa;"></i>
              <div class="text-xs font-semibold uppercase tracking-wide" style="color: #93c5fd;">Debt Corpus Remaining</div>
            </div>
            <div id="resDebt" class="font-extrabold mt-2" style="font-size: 1.2rem; color: #93c5fd;">—</div>
          </div>

          <div class="rounded-xl p-4 text-center" style="background: rgba(5,150,105,0.12); border: 1px solid rgba(5,150,105,0.3);">
            <div class="flex items-center justify-center gap-1.5 mb-1">
              <i class="ph ph-trend-up" style="font-size: 1rem; color: #34d399;"></i>
              <div class="text-xs font-semibold uppercase tracking-wide" style="color: #6ee7b7;">Equity Corpus Built</div>
            </div>
            <div id="resEquity" class="font-extrabold mt-2" style="font-size: 1.2rem; color: #6ee7b7;">—</div>
          </div>

          <div class="rounded-xl p-4 text-center" style="background: rgba(212,175,55,0.1); border: 1px solid rgba(212,175,55,0.35);">
            <div class="flex items-center justify-center gap-1.5 mb-1">
              <i class="ph ph-wallet" style="font-size: 1rem; color: #D4AF37;"></i>
              <div class="text-xs font-semibold uppercase tracking-wide" style="color: #D4AF37;">Total Portfolio</div>
            </div>
            <div id="resTotal" class="font-extrabold mt-2" style="font-size: 1.3rem; color: #D4AF37;">—</div>
          </div>

        </div>

        <!-- Comparison section -->
        <div class="rounded-xl p-5" style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);">
          <div class="flex items-center gap-2 mb-4">
            <i class="ph ph-scales" style="font-size: 1.1rem; color: rgba(255,255,255,0.6);"></i>
            <span class="text-sm font-semibold" style="color: rgba(255,255,255,0.75);">Strategy Comparison</span>
          </div>

          <!-- vs Direct Equity -->
          <div class="flex items-start justify-between gap-4 mb-4 pb-4" style="border-bottom: 1px solid rgba(255,255,255,0.08);">
            <div>
              <div class="text-sm font-semibold text-white mb-0.5">vs. Direct Equity Investment</div>
              <div class="text-xs" style="color: rgba(255,255,255,0.5);">If you had invested the entire lump sum directly in equity at the start</div>
            </div>
            <div class="text-right flex-shrink-0">
              <div id="cmpDirectEquityVal" class="text-sm font-bold text-white mb-1">—</div>
              <div id="cmpDirectEquityBadge">—</div>
            </div>
          </div>

          <!-- vs Debt Only -->
          <div class="flex items-start justify-between gap-4">
            <div>
              <div class="text-sm font-semibold text-white mb-0.5">vs. Debt Only</div>
              <div class="text-xs" style="color: rgba(255,255,255,0.5);">If you had kept the entire lump sum in the debt fund throughout</div>
            </div>
            <div class="text-right flex-shrink-0">
              <div id="cmpDebtOnlyVal" class="text-sm font-bold text-white mb-1">—</div>
              <div id="cmpDebtOnlyBadge">—</div>
            </div>
          </div>

        </div>

      </div>

      <!-- Month-by-Month Table -->
      <div class="card-glass p-6 md:p-8">
        <div class="flex items-center gap-2 mb-5">
          <i class="ph ph-table" style="font-size: 1.3rem; color: #D4AF37;"></i>
          <h2 class="font-bold text-white" style="font-size: 1.05rem;">Month-by-Month Breakdown</h2>
          <span id="tableCaption" class="text-xs label-muted ml-1"></span>
        </div>

        <div class="overflow-x-auto rounded-lg" style="border: 1px solid rgba(255,255,255,0.1);">
          <table class="w-full text-sm">
            <thead>
              <tr style="background: rgba(212,175,55,0.12);">
                <th class="text-left px-3 py-2.5 font-semibold" style="color: #D4AF37; white-space: nowrap;">Month</th>
                <th class="text-right px-3 py-2.5 font-semibold" style="color: #93c5fd; white-space: nowrap;">Debt Corpus</th>
                <th class="text-right px-3 py-2.5 font-semibold" style="color: #6ee7b7; white-space: nowrap;">Equity Corpus</th>
                <th class="text-right px-3 py-2.5 font-semibold" style="color: #D4AF37; white-space: nowrap;">Total Corpus</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </div>

    </div>
  </section>

  <!-- Footer -->
  <footer class="text-center py-8 px-4" style="border-top: 1px solid rgba(255,255,255,0.1);">
    <div class="max-w-3xl mx-auto">
      <a href="../index.html" class="inline-flex items-center gap-2 text-sm font-medium mb-4 no-underline"
        style="color: rgba(212,175,55,0.8); text-decoration: none;">
        <i class="ph ph-arrow-left"></i>
        Back to All Calculators
      </a>
      <p class="text-xs" style="color: rgba(255,255,255,0.35);">
        Wealth Builder &copy; 2025 &mdash; For educational purposes only. Not financial advice.
      </p>
    </div>
  </footer>

  <script src="../assets/js/app.js"></script>
  <script>
    // ── Core STP Calculation ──────────────────────────────────────────────────
    function calculateSTP(lumpSum, monthlyTransfer, debtRate, equityRate, months) {
      const dr = debtRate / 100 / 12;
      const er = equityRate / 100 / 12;
      let debtCorpus = lumpSum;
      let equityCorpus = 0;
      let totalTransferred = 0;
      const breakdown = [];

      for (let m = 1; m <= months; m++) {
        debtCorpus = debtCorpus * (1 + dr);
        const transfer = Math.min(monthlyTransfer, debtCorpus);
        debtCorpus -= transfer;
        totalTransferred += transfer;

        equityCorpus = (equityCorpus + transfer) * (1 + er);

        breakdown.push({
          month: m,
          debtCorpus: Math.round(debtCorpus),
          equityCorpus: Math.round(equityCorpus),
          totalCorpus: Math.round(debtCorpus + equityCorpus)
        });
      }

      const totalCorpus = debtCorpus + equityCorpus;
      const directEquityValue = lumpSum * Math.pow(1 + equityRate / 100 / 12, months);
      const debtOnlyValue = lumpSum * Math.pow(1 + debtRate / 100 / 12, months);

      return { debtCorpus, equityCorpus, totalCorpus, totalTransferred, breakdown, directEquityValue, debtOnlyValue };
    }

    // ── Comparison Badge ──────────────────────────────────────────────────────
    function compBadge(stpVal, benchVal) {
      const diff = stpVal - benchVal;
      const pct = ((diff / benchVal) * 100).toFixed(1);
      if (diff >= 0) {
        return '<span class="badge-better">▲ STP outperforms by ' + formatINR(Math.abs(diff)) + ' (+' + pct + '%)</span>';
      }
      return '<span class="badge-worse">▼ STP trails by ' + formatINR(Math.abs(diff)) + ' (' + pct + '%)</span>';
    }

    // ── Main Calculate ────────────────────────────────────────────────────────
    function calculate() {
      const lumpSum       = parseFloat(document.getElementById('lumpSum').value);
      const monthlyTransfer = parseFloat(document.getElementById('transfer').value);
      const debtRate      = parseFloat(document.getElementById('debtRate').value);
      const equityRate    = parseFloat(document.getElementById('equityRate').value);
      const months        = parseInt(document.getElementById('duration').value, 10);

      const r = calculateSTP(lumpSum, monthlyTransfer, debtRate, equityRate, months);

      // ── Update flow diagram ──
      document.getElementById('flowDebtVal').textContent   = formatINR(r.debtCorpus);
      document.getElementById('flowEquityVal').textContent = formatINR(r.equityCorpus);
      document.getElementById('flowTransferVal').textContent = formatINR(monthlyTransfer) + '/mo';

      // ── Summary cards ──
      document.getElementById('resDebt').textContent   = formatINR(r.debtCorpus);
      document.getElementById('resEquity').textContent = formatINR(r.equityCorpus);
      document.getElementById('resTotal').textContent  = formatINR(r.totalCorpus);

      // ── Comparison ──
      document.getElementById('cmpDirectEquityVal').textContent = formatINR(r.directEquityValue);
      document.getElementById('cmpDirectEquityBadge').innerHTML = compBadge(r.totalCorpus, r.directEquityValue);

      document.getElementById('cmpDebtOnlyVal').textContent = formatINR(r.debtOnlyValue);
      document.getElementById('cmpDebtOnlyBadge').innerHTML = compBadge(r.totalCorpus, r.debtOnlyValue);

      // ── Month-by-month table ──
      const showAll = months <= 24;
      const rowsToShow = showAll ? r.breakdown : r.breakdown.slice(0, 12);
      document.getElementById('tableCaption').textContent =
        showAll ? '(all ' + months + ' months)' : '(first 12 of ' + months + ' months)';

      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = '';
      rowsToShow.forEach((row, i) => {
        const tr = document.createElement('tr');
        tr.style.background = i % 2 === 0 ? 'rgba(255,255,255,0.03)' : 'transparent';
        tr.innerHTML =
          '<td class="px-3 py-2.5 font-semibold" style="color:#D4AF37;">Month ' + row.month + '</td>' +
          '<td class="px-3 py-2.5 text-right" style="color:#93c5fd;">' + formatINR(row.debtCorpus) + '</td>' +
          '<td class="px-3 py-2.5 text-right" style="color:#6ee7b7;">' + formatINR(row.equityCorpus) + '</td>' +
          '<td class="px-3 py-2.5 text-right font-semibold" style="color:#D4AF37;">' + formatINR(row.totalCorpus) + '</td>';
        tbody.appendChild(tr);
      });
    }

    // ── Slider wiring ─────────────────────────────────────────────────────────
    function wire(sliderId, displayId, formatter) {
      const el   = document.getElementById(sliderId);
      const disp = document.getElementById(displayId);
      el.addEventListener('input', () => {
        disp.textContent = formatter(parseFloat(el.value));
        calculate();
      });
    }

    wire('lumpSum',    'lumpSumVal',  v => formatINR(v));
    wire('transfer',   'transferVal', v => formatINR(v));
    wire('debtRate',   'debtRateVal', v => v + '%');
    wire('equityRate', 'equityRateVal', v => v + '%');
    wire('duration',   'durationVal', v => v + ' months');

    // Initial render
    calculate();
  </script>

</body>
</html>
